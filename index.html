<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#dadada">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="description" content="Your keyboard's best friend" />
  <meta data-react-helmet="true" property="og:title" content="VIA">
  <meta data-react-helmet="true" name="description" content="Your keyboard&#x27;s best friend">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Sans+Condensed:wght@300;400;500&family=Fira+Sans:wght@300;400&display=swap" rel="stylesheet">
  <title>VIA</title>
  <script id="definition_hash" data-hash=<%-hash%>></script>

  <style>
    /* ä¿®æ­£é¡µé¢æº¢å‡ºçš„åŸºç¡€è®¾ç½® */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      /* æ ¸å¿ƒï¼šé˜²æ­¢å†…å®¹æ’‘å¼€äº§ç”Ÿæ¨ªå‘æ»šåŠ¨æ¡ */
      overflow-x: hidden; 
      height: 100%;
      
    }

    /* 1. å…¨å±é®ç½©å±‚ */
    #guide-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw; /* ä½¿ç”¨ vw ç¡®ä¿è¦†ç›–è§†å£ */
      height: 100vh;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px); /* å…¼å®¹ Safari */
      z-index: 10000;
      justify-content: center;
      align-items: center;
      font-family: 'Fira Sans', sans-serif;
    }

    /* 2. å¼•å¯¼å¡ç‰‡æ ·å¼ */
    .guide-card {
      background: #ffffff;
      padding: 30px;
      border-radius: 20px;
      max-width: 800px;
      width: 85%;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      animation: modalPop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      /* ç¡®ä¿å¡ç‰‡å†…éƒ¨å†…å®¹ä¸ä¼šæº¢å‡º */
      box-sizing: border-box; 
    }

    @keyframes modalPop {
      from { opacity: 0; transform: scale(0.9) translateY(10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    .guide-card h2 {
      margin-top: 0;
      color: #da532c;
      font-size: 24px;
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
    }

    .guide-step-list {
      margin: 20px 0;
      list-style: none;
      padding: 0;
    }

    .guide-step-item {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      align-items: flex-start;
    }

    .step-badge {
      background: #f0f0f0;
      color: #da532c;
      font-weight: bold;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-shrink: 0;
      font-size: 18px;
    }

    .step-text {
      color: #444;
      font-size: 16px;
      line-height: 1.6;
      font-family: 'Inter', 'Fira Sans', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Microsoft YaHei", sans-serif;
    }

    .guide-footer-btn {
      width: 100%;
      background: #da532c;
      color: white;
      border: none;
      padding: 12px;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }

    .guide-footer-btn:hover {
      background: #b84323;
    }

    /* 3. å³ä¸‹è§’å¸¸é©»è§¦å‘æŒ‰é’® */
    #guide-fab {
      position: fixed;
      bottom: 25px;
      right: 25px;
      width: 46px;
      height: 46px;
      background: #da532c;
      color: white;
      border-radius: 50%;
      border: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      z-index: 999;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      transition: all 0.3s ease;
    }

    #guide-fab:hover {
      transform: scale(1.05);
      background: #b84323;
    }

    /* è§£å†³éšè—æ»šåŠ¨æ¡å¯¼è‡´çš„é¡µé¢æŠ–åŠ¨ */
    .no-scroll {
      overflow: hidden !important;
      padding-right: var(--scrollbar-width, 0px); /* åŠ¨æ€å ä½ï¼Œé˜²æ­¢æŠ–åŠ¨ */
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <button id="guide-fab" onclick="openGuide()" title="å¸®åŠ©è¯´æ˜">
    <span>?</span>
  </button>

  <div id="guide-overlay" onclick="closeGuide(event)">
    <div class="guide-card" onclick="event.stopPropagation()">
      <h2>æ¬¢è¿ä½¿ç”¨ VIA ğŸ‘‹</h2>
      <div class="guide-step-list">
        <div class="guide-step-item">
          <div class="step-badge">1</div>
          <div class="step-text">ä½¿ç”¨ USB çº¿è¿æ¥æ‚¨çš„é”®ç›˜ã€‚</div>
        </div>
        <div class="guide-step-item">
          <div class="step-badge">2</div>
          <div class="step-text">ç‚¹å‡» <b>"Authorize Device"</b> é€‰æ‹©æ‚¨çš„é”®ç›˜ã€‚</div>
        </div>
        <div class="guide-step-item">
          <div class="step-badge">3</div>
          <div class="step-text">åŠ è½½æˆåŠŸåï¼Œç‚¹å‡»é€‰æ‹©æˆ–åŒå‡»æŒ‰é”®å®æ—¶ä¿®æ”¹æ˜ å°„å…³ç³»ã€‚</div>
        </div>
        <div class="guide-step-item">
          <div class="step-badge">4</div>
          <div class="step-text">å¯ä»¥ç‚¹å‡»æœ€ä¸Šé¢èœå•æ¥åˆ‡æ¢ç•Œé¢è¯­è¨€ã€‚</div>
        </div>
      </div>
      <div style="background: #fff8f0; padding: 12px; border-radius: 8px; font-size: 16px;  color: #856404; border: 1px solid #ffeeba; margin-bottom: 20px;">
        ğŸ’¡ <b>æç¤ºï¼š</b>å¦‚æœæ— æ³•è¯†åˆ«ï¼Œè¯·åœ¨ Settings å¼€å¯ "Show Design tab" å¹¶ä¸Šä¼  jsonï¼ˆè”ç³»å–å®¶è·å–jsonï¼‰ã€‚
      </div>
      <button class="guide-footer-btn" onclick="closeGuide()">æˆ‘çŸ¥é“äº†</button>
    </div>
  </div>

  <noscript>You need to enable JavaScript to run this app.</noscript>
  <script type="module" src="/src/index.tsx"></script>

  <script>
    const STORAGE_KEY = 'via_user_has_onboarded';
    const overlay = document.getElementById('guide-overlay');

    // è®¡ç®—æ»šåŠ¨æ¡å®½åº¦å¹¶è®¾ç½® CSS å˜é‡ï¼ˆé˜²æ­¢é¡µé¢æŠ–åŠ¨ï¼‰
    function getScrollbarWidth() {
      return window.innerWidth - document.documentElement.clientWidth;
    }

    // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥çŠ¶æ€
    window.addEventListener('DOMContentLoaded', () => {
      // è®¾ç½®æ»šåŠ¨æ¡å®½åº¦å˜é‡
      document.documentElement.style.setProperty('--scrollbar-width', getScrollbarWidth() + 'px');
      
      const hasOnboarded = localStorage.getItem(STORAGE_KEY);
      if (!hasOnboarded) {
        openGuide();
      }
    });

    // æ‰“å¼€å¼•å¯¼
    function openGuide() {
      overlay.style.display = 'flex';
      document.body.classList.add('no-scroll');
    }

    // å…³é—­å¼•å¯¼
    function closeGuide(e) {
      overlay.style.display = 'none';
      document.body.classList.remove('no-scroll');
      localStorage.setItem(STORAGE_KEY, 'true');
    }

    // Esc é”®å…³é—­
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && overlay.style.display === 'flex') {
        closeGuide();
      }
    });
  </script>
</body>

</html>